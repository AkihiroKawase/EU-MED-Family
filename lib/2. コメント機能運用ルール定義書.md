## 2.1. スレッド表現 (親子関係と階層)
- コメントへの返信（スレッド）は、parentIdフィールドとdepthフィールドを用いて表現します。
- •トップレベルのコメント (親コメント)
- •parentIdにはnullを設定します。
- •depthには0を設定します。
- •返信コメント (子コメント)
- •parentIdには、返信対象のコメントのドキュメントIDを設定します。
- •depthには、親のdepth + 1 を設定します。（例: 親がdepth: 0なら、子はdepth: 1）•アプリのUI上、一定の深さ（例: depthが3以上）の返信はインデントを増やさない、または返信ボタンを非表示にすることを検討します。

## 2.2. ソフト削除と非表示運用
- ユーザー体験とデータ整合性を考慮し、コメントの削除はソフト削除方式を採用します。
- •ユーザーによる削除 (ソフト削除)
- •ユーザーが自身のコメントを削除した場合、データベースからドキュメントを物理的に削除する（ハード削除）のではなく、commentsドキュメントのisDeletedフィールドをtrueに更新します。
- •クライアントアプリは、isDeletedがtrueのコメントを検知した場合、authorIdやtextの内容を表示せず、「このコメントは削除されました」という固定メッセージを表示します。
- •このコメントに返信（子コメント）が付いている場合でも、そのツリー構造は維持されます。これにより、「削除されたコメントへの返信」が表示される状況を自然に表現できます。
- •管理者による非表示 (将来的な拡張)•もし将来的に、利用規約違反のコメントを管理者権限で非表示にする機能が必要になった場合は、isHidden: booleanのようなフィールドをcommentsスキーマに追加することを検討します。
- •isHidden: trueのドキュメントは、セキュリティルールレベルで読み取りを拒否するか、クライアント側で完全に非表示（レンダリングしない）として扱います。これはisDeleted（削除された事実を”表示する”）とは異なる挙動です。