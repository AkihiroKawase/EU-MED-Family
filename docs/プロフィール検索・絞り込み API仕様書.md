## プロフィール検索・絞り込み API仕様書

### 1. エンドポイント

`GET /users`

### 2. クエリパラメータ

| パラメータ | 型 | 必須 | 説明 |
| :--- | :--- | :--- | :--- |
| `q` | String | 任意 | **キーワード検索（前方一致）。** ユーザーの `displayName` (表示名) の先頭から一致するものを検索する。 |
| `currentCountry` | String | 任意 | **現在の国 絞り込み。** 国名（完全一致）を指定する。 |
| `school` | String | 任意 | **大学 絞り込み。** 大学名（完全一致）を指定する。 |
| `grade` | String | 任意 | **学年 絞り込み。** 学年（完全一致）を指定する。 |
| `sort` | String | 任意 | **並び順。** `createdAt_desc` (新着順) を指定。デフォルトは `createdAt_desc`。 |

### 3. 検索ロジック

* `q`, `currentCountry`, `school`, `grade` の各条件が指定された場合、すべて **AND条件** で結合されます。
* （例: `currentCountry` が "ハンガリー" **かつ** `school` が "デブレツェン大学" のユーザー）
* `sort` は、定義されたインデックスに基づき、`createdAt` (降順) のみサポートします。
* キーワード検索 (`q`) は、Firestoreのクエリ (`>=`, `<= \uf8ff`) を利用した前方一致検索として実装します。

### 4. 具体例

#### 例1: デフォルト (新着順)

`GET /users`

* すべてのユーザーを新着順 (`createdAt` 降順) で取得します。

#### 例2: 国と学年での絞り込み

`GET /users?currentCountry=ハンガリー&grade=1年生`

* 現在の国が「ハンガリー」であり、
* **かつ**
* 学年が「1年生」であるユーザーを新着順で取得します。

#### 例3: キーワード検索（前方一致）

`GET /users?q=Taro`

* `displayName` が "Taro" で始まるユーザー（例: "Taro", "TaroYamada"）を新着順で取得します。

#### 例4: 絞り込みとキーワード検索の組み合わせ

`GET /users?currentCountry=日本&q=Hana`

* 現在の国が「日本」であり、
* **かつ**
* `displayName` が "Hana" で始まるユーザーを新着順で取得します。